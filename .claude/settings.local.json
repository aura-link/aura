{
  "permissions": {
    "allow": [
      "Bash(ssh:*)",
      "Bash(ping:*)",
      "Bash(curl:*)",
      "Bash(python3:*)",
      "Bash(scp:*)",
      "Bash(pip install:*)",
      "Bash(TOKEN=\"bef769ff-2d8b-4e29-90b2-4494c4e59839\")",
      "WebFetch(domain:contabo.com)",
      "Bash(TOKEN=\"bdf38a84-1947-4ee2-85ac-d8fdb36dcb43\")",
      "Bash(fi)",
      "Bash(# Login and capture full response including headers curl -sk -X POST \"\"https://217.216.85.65/nms/api/v2.1/user/login\"\" -H \"\"Content-Type: application/json\"\" -d \"\"{\\\\\"\"username\\\\\"\":\\\\\"\"AURALINK\\\\\"\",\\\\\"\"password\\\\\"\":\\\\\"\"Varce*101089\\\\\"\"}\"\" -i)",
      "Bash(# Get the UISP config from the antenna curl -sk -X POST \"\"https://10.1.1.253/api/auth\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"username\"\":\"\"AURALINK\"\",\"\"password\"\":\"\"Auralink2021\"\"}'' -b /tmp/ant253_cookies -c /tmp/ant253_cookies # Get system config related to UNMS curl -sk \"\"https://10.1.1.253/api/v1.0/system\"\" -b /tmp/ant253_cookies)",
      "Bash(# Get UNMS/UISP specific settings from the antenna curl -sk \"\"https://10.1.1.253/api/v1.0/system/cfg/unms\"\" -b /tmp/ant253_cookies || \\\\ curl -sk \"\"https://10.1.1.253/api/v1.0/system/unms\"\" -b /tmp/ant253_cookies || \\\\ curl -sk \"\"https://10.1.1.253/system.cfg\"\" -b /tmp/ant253_cookies)",
      "Bash(pkill:*)",
      "Bash(# Test various endpoints the UISP app might use echo \"\"=== Main page ===\"\" curl -sk -w \"\"HTTP:%{http_code}\"\" -o /dev/null \"\"https://server.auralink.link\"\" echo \"\"\"\" echo \"\"=== API ===\"\" curl -sk -w \"\"HTTP:%{http_code}\"\" -o /dev/null \"\"https://server.auralink.link/nms/api/v2.1/nms/setup\"\" echo \"\"\"\" echo \"\"=== API response ===\"\" curl -sk \"\"https://server.auralink.link/nms/api/v2.1/nms/setup\"\" echo \"\"\"\" echo \"\"=== WebSocket test ===\"\" curl -sk -w \"\"HTTP:%{http_code}\"\" -o /dev/null -H \"\"Upgrade: websocket\"\" -H \"\"Connection: Upgrade\"\" \"\"https://server.auralink.link/nms/ws\"\" echo \"\"\"\" echo \"\"=== Login test ===\"\" curl -sk -w \"\"\\\\nHTTP:%{http_code}\"\" -X POST \"\"https://server.auralink.link/nms/api/v2.1/user/login\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"username\"\":\"\"AURALINK\"\",\"\"password\"\":\"\"Varce*101089\"\"}'')",
      "Bash(# The login response might be empty due to truncation, let me check it separately curl -sk -X POST \"\"https://server.auralink.link/nms/api/v2.1/user/login\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"username\"\":\"\"AURALINK\"\",\"\"password\"\":\"\"Varce*101089\"\"}'' -w \"\"\\\\nHTTP:%{http_code}\"\")",
      "Bash(nslookup:*)",
      "Bash(unms.uri=.*)",
      "Bash(unms.uri=$NEW_KEY)",
      "Bash(' /tmp/system.cfg\n                else\n                    echo 'unms.uri=$NEW_KEY' >> /tmp/system.cfg\n                fi\n                if ! grep -q 'unms.status=enabled' /tmp/system.cfg; then\n                    echo 'unms.status=enabled' >> /tmp/system.cfg\n                fi\n                cfgmtd -w -p /etc/ 2>/dev/null\n                echo UPDATED_OK\n            \"\" 2>/dev/null | grep -q \"\"UPDATED_OK\"\"\n            \n            if [ $? -eq 0 ]; then\n                echo \"\"  [$IP] OK - Key actualizada \\($USER\\)\"\"\n                OK=$\\(\\(OK+1\\)\\)\n            else\n                echo \"\"  [$IP] FAIL - Error al guardar config \\($USER\\)\"\"\n                FAIL=$\\(\\(FAIL+1\\)\\)\n            fi\n            UPDATED=1\n            return 0\n        fi\n    done\n    \n    if [ $UPDATED -eq 0 ]; then\n        NOSSH=$\\(\\(NOSSH+1\\)\\)\n        return 1\n    fi\n}\n\necho \"\"============================================\"\"\necho \"\"  UISP Key Update - Antenas Ubiquiti\"\"\necho \"\"============================================\"\"\necho \"\"Nueva key: ...sBRaeWB1kiH4...+allowSelfSignedCertificate\"\"\necho \"\"\"\"\n\n# IPs a procesar \\(pasadas como argumentos o desde archivo\\)\nif [ -f /tmp/antenna_ips.txt ]; then\n    TOTAL=$\\(wc -l < /tmp/antenna_ips.txt\\)\n    echo \"\"Procesando $TOTAL antenas...\"\"\n    echo \"\"\"\"\n    COUNT=0\n    while read IP; do\n        COUNT=$\\(\\(COUNT+1\\)\\)\n        echo \"\"[$COUNT/$TOTAL] Procesando $IP...\"\"\n        update_antenna \"\"$IP\"\"\n    done < /tmp/antenna_ips.txt\nelse\n    echo \"\"ERROR: No se encontro /tmp/antenna_ips.txt\"\"\n    exit 1\nfi\n\necho \"\"\"\"\necho \"\"============================================\"\"\necho \"\"  RESUMEN\"\"\necho \"\"============================================\"\"\necho \"\"  Actualizadas: $OK\"\"\necho \"\"  Ya correctas: $SKIP\"\"\necho \"\"  Error SSH:    $NOSSH\"\"\necho \"\"  Fallidas:     $FAIL\"\"\necho \"\"============================================\"\"\nENDSCRIPT\nchmod +x /tmp/uisp-key-update.sh && echo \"\"Script creado OK\"\"')",
      "Bash(sshpass:*)",
      "Bash(ssh-copy-id:*)",
      "Bash(# The issue was piping through SSH - let me parse the saved file instead cat /tmp/ppp_raw.txt || ssh -o StrictHostKeyChecking=no admin@10.147.17.11 ''/ppp active print terse'' && cat /tmp/ppp_raw.txt)",
      "Bash(xxd:*)",
      "Bash(echo:*)",
      "Bash(python:*)",
      "Bash(git status:*)",
      "Bash(git init:*)",
      "Bash(git branch:*)",
      "Bash(git add:*)"
    ]
  }
}
